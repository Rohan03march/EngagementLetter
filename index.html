<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Source One - Engagement Letter (2 Page A4)</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">
<style>
:root {
  --left-width:420px;
  --gap:24px;
  --brand:#de3f6a;
  --bg:#f2f4f8;
  --text:#222;
  --border:#ddd;
}
html,body{
  height:100%;
  margin:0;
  font-family:"Times New Roman",serif;
  background:var(--bg);
  color:var(--text);
}
.app{
  display:flex;
  gap:var(--gap);
  padding:20px;
  height:100vh;
  box-sizing:border-box;
}
.panel-left{
  width:var(--left-width);
  background:white;
  padding:20px 18px;
  border-radius:12px;
  box-shadow:0 8px 28px rgba(0,0,0,0.08);
  display:flex;
  flex-direction:column;
  gap:14px;
  overflow:auto;
  border-top:4px solid var(--brand);
}
.panel-left h3{
  font-family:'Playfair Display',serif;
  font-size:20px;
  margin:0 0 6px;
  color:var(--brand);
}
.panel-left label{
  font-weight:500;
  font-family:'Roboto',sans-serif;
  font-size:14px;
  margin-top:6px;
}
.panel-left input{
  padding:9px;
  border:1px solid var(--border);
  border-radius:8px;
  font-size:14px;
  width:100%;
  box-sizing:border-box;
  outline:none;
}
.panel-left input:focus{
  border-color:var(--brand);
  box-shadow:0 0 0 2px rgba(222,63,106,0.1);
}
.sig-wrap{
  border:1px dashed var(--border);
  padding:8px;
  background:#fafafa;
  border-radius:6px;
}
canvas#sig-canvas{
  width:100%;
  height:120px;
  background:white;
  border-radius:4px;
  touch-action:none;
}
button{
  padding:10px 14px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  font-family:'Roboto',sans-serif;
  font-weight:500;
}
button.primary{
  background:var(--brand);
  color:#fff;
  transition:background 0.2s;
}
button.primary:hover{
  background:#c6355d;
}
button:not(.primary){
  background:#eee;
}
.panel-right{
  flex:1;
  overflow:auto;
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding:20px;
}
.a4-sheet{
  width:19cm;
  min-height:27.7cm;
  background:white;
  box-sizing:border-box;
  border-radius:10px;
  box-shadow:0 0 12px rgba(0,0,0,0.08);
  margin-bottom:1.2cm;
  position:relative;
}
.page-break{margin-top:1cm;}
.header-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:0.5cm;
  border-bottom:1px solid #eee;
  padding-bottom:0.2cm;
}
.header-left img{height:1.4cm;}
.header-right{text-align:right;font-size:0.38cm;line-height:1.05;}
.mobile{color:var(--brand);font-weight:700;display:block;margin-top:0.05cm;}
.body{font-size:0.36cm;color:#333;line-height:1.4;}
.body p{margin:0 0 0.3cm 0;text-align:justify;}
.body ol{margin:0 0 0.28cm 0.4cm;padding-left:0.2cm;}
.body li{margin-bottom:0.18cm;}
.sign-row{
  display:flex;
  justify-content:space-between;
  gap:0.6cm;
  margin-top:1cm;
  align-items:center;
  position:relative;
  z-index:2;
}
.sign-box{width:28%;font-size:0.36cm;}
.sign-image{
  display:block;
  margin-top:0.25cm;
  max-width:8.4cm;
  height:auto;
  border:none;
}
.footer {
  position: absolute;
  bottom: 0.8cm;
  left: 0;
  width: 100%;
  text-align: center;
  font-size: 0.35cm;
  color: #333;
}
.footer hr {
  border: 0;
  border-top: 0.2px solid #aaa;
  margin-bottom: 0.2cm;
}
@media print{
  .panel-left{display:none!important;}
  .app{box-shadow:none;background:white;}
  .a4-sheet{box-shadow:none;border-radius:0;}
}

/* ‚úÖ MOBILE RESPONSIVE FIXES */
@media (max-width:900px){
  .app{
    flex-direction:column;
    height:auto;
    padding:12px;
  }
  .panel-left{
    width:100%;
    max-width:100%;
    border-radius:8px;
    order:1;
  }
  .panel-right{
    order:2;
    padding:10px 0;
  }
  .a4-sheet{
    width:100%;
    min-height:auto;
    margin-bottom:20px;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
    border-radius:8px;
    padding:12px;
  }
  .header-row{
    flex-direction:column;
    text-align:center;
    gap:6px;
  }
  .header-left img{
    height:1.2cm;
  }
  .header-right{
    font-size:12px;
    text-align:center;
  }
  .body{
    font-size:13px;
    line-height:1.5;
  }
  .sign-row{
    flex-direction:column;
    gap:10px;
    text-align:center;
  }
  .sign-box{
    width:100%;
  }
  /* -------- PDF / Print Mode: Always Use Desktop A4 Style -------- */
@media print {
  body {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  .app {
    flex-direction: row !important;
  }

  .panel-left {
    display: none !important; /* hide input panel */
  }

  .panel-right {
    width: 100% !important;
    padding: 0 !important;
  }

  .a4-sheet {
    width: 21cm !important;
    min-height: 29.7cm !important;
    margin: 0 auto !important;
    box-shadow: none !important;
    border: none !important;
    page-break-after: always !important;
  }

  .header-row {
    flex-direction: row !important;
    text-align: left !important;
  }

  .body {
    font-size: 14px !important;
    line-height: 1.6 !important;
  }
}

/* -------- Force desktop layout inside PDF even on mobile -------- */
#preview {
  width: 21cm !important;
  min-height: 29.7cm !important;
  margin: 0 auto;
  background: white;
}

@media screen and (max-width: 900px) {
  #preview {
    transform: scale(1);
    transform-origin: top center;
  }
}

}
</style>
</head>
<body>
<div class="app">
  <!-- Left Panel -->
  <div class="panel-left" id="left-panel">
    <h3>Engagement Details</h3>
    <label>Employee Name</label>
    <input id="employeeName" type="text" placeholder="Enter Your Name">
    <label>Contract Start Date</label>
    <input id="startDate" type="date">
    <label>Contract End Date</label>
    <input id="endDate" type="date">
    <label>Engagement Date</label>
    <input id="engageDate" type="date">

    <label>Employee Signature</label>
    <div class="sig-wrap">
      <canvas id="sig-canvas"></canvas>
      <div style="display:flex;justify-content:space-between;margin-top:6px;">
        <button id="clear-sig">Clear</button>
        <button id="save-sig" class="primary">Save</button>
      </div>
    </div>

    <button id="generateBtn" class="primary" style="margin-top:10px;">Generate &amp; Download PDF</button>
  </div>

  <!-- Right Preview -->
  <div class="panel-right">
  <div id="preview">
    <!-- PAGE 1 -->
    <div class="a4-sheet" id="page1">
      <div class="header-row">
        <div class="header-left">
          <img src="https://res.cloudinary.com/dtwcxssvj/image/upload/v1746523573/SourceOneLogo_ubsxye.png" alt="logo">
        </div>
        <div class="header-right">
          <div><b>Email : sourceonelokesh@rediffmail.com</b></div>
          <div><b>sourceone.chandan@gmail.com</b></div>
          <div class="mobile">Mobile: 9741965944, 080-23476868</div>
        </div>
      </div>

      <div id="letter-original" class="body">
        <p><b>1:</b> Your contract will commence from <b><u></u></b> and expire on <b><u></u></b> during which you will render services ... executed by you on<b><u></u></b> ...</p>
        <p style="text-align:center;"><b>You hereby agree to be liable for the following terms and conditions:</b></p>
        <ol>
          <li>Fully perform the services, in a professional manner, at the Client‚Äôs location until the completion of the term of the Work assignment.</li>
          <li>During the term of the work assignment, render services exclusively to the Client and such performance shall not be inconsistent with any obligation you may have to other third parties.</li>
          <li>Not engage in any conduct which is detrimental to the interest of the Client or SOURCE ONE.</li>
          <li>Not receive any payments of any nature directly or indirectly from the Client unless agreed to by SOURCE ONE.</li>
          <li>Neither directly nor indirectly offers you for employment with the Client or its affiliates during the period of the work assignment without prior permission of SOURCE ONE.</li>
          <li>Extend all cooperation to the Client‚Äôs employees, consultants, representatives, etc. and do all such things as may be necessary and comply with all terms of the Appointment letter so as to effectively under take the work.</li>
          <li>Report and be present at the designated location during the working hours mentioned herein and abide by the rules and regulations as required by the Client.</li>
          <li>Comply with the safety, health and other rules and regulations of SOURCE ONE and the SOURCE ONE Client that you have been made aware of.</li>
          <li>During the course of your contract, you can be transferred to allocation within the territory of India as and when required by SOURCE ONE for executing the services provided herein.</li>
        </ol>

        <p><b>2:</b> Should you be selected to perform the Work Assignment, the nature of your relationship with SOURCE ONE will be that of a Contract of Service for a fixed period. By executing this letter of engagement neither do we offer you employments with SOURCE ONE nor do you become an employee of SOURCE ONE. Upon expiry or termination of the Work Assignment, your employment with SOURCE ONE shall stand terminated forth with.</p>
        <p><b>3:</b> If the employee desires to leave the company, he/ she needs to serve notice period of ‚Äò15‚Äô days in prior and give a written letter. If Employeeis not serving complete notice period then short served days will be deducted from his/her salary, employee will be eligible for salary only if he/she works for minimum 7 days with us.</p>
        <p><b>4:</b> The Employee is responsible for all company assets under their supervision. They are account able for any asset loss or damage that occurs during their presence or under their process control, even if not directly involved. The Company may recover the cost of lost or damaged assets from the Employee's remuneration. The Employee will be notified of any recovery decision.</p>
        <p><b>5:</b> Termination of this letter of engagement shall not affect the obligations of the parties that have been incurred prior to such termination and SOURCE ONE shall promptly settle all your dues after making the applicable deductions.</p>
        <p><b>6:</b> You agree to defend, indemnify and hold SOURCE ONE or the Client harmless from any and all claims, damages, liability, attorney‚Äôs fees and expenses on account of your failure to satisfy any of your obligations under this work assignment letter or for misconduct or for violation of any law or creation of any legal liability by you.</p>
        <p><b>7:</b> Any dispute between you and SOURCE ONE shall be referred to a sole arbitrator appointed by SOURCE ONE the arbitration shall be conducted in English language, in accordance with the Arbitration and Conciliation Act 1996, at Bangalore, Karnataka, India. This Engagement Letter shall be governed by the laws of India.</p>
      </div>

      <!-- Footer Page 1 -->
      <div class="footer">
        <hr>
        <p><b>Address:</b> #49/3,MEC Road, Industrial Subrub, Marappanapalya, Yeshwanthpura, Bengaluru - 560022</p>
      </div>
    </div>

    <!-- PAGE 2 -->
    <div class="a4-sheet page-break" id="page2">
      <div class="header-row">
        <div class="header-left">
          <img src="https://res.cloudinary.com/dtwcxssvj/image/upload/v1746523573/SourceOneLogo_ubsxye.png" alt="logo">
        </div>
        <div class="header-right">
          <div><b>Email : sourceonelokesh@rediffmail.com</b></div>
          <div><b>sourceone.chandan@gmail.com</b></div>
          <div class="mobile">Mobile: 9741965944, 080-23476868</div>
        </div>
      </div>

      <div class="body">
        <p><b>9:</b> Details of your salary breakup will be as per the Annexure attached herein. You hereby authorize SOURCE ONE to make all salary payments required to be made to you by SOURCE ONE including all reimbursements either by way of Cheque or by directly crediting the amounts to your bank account.</p>
        <p><b>10:</b> You shall be subject to background check and in the even the background check is negative, the company reserves the right to terminate your employment without any further notice.</p>
        <p><b>11:</b> Please note that we want to keep payout time cycle of 21st to 20th of every month, salary payout will happen by 9th of next month.</p>
        <p><b>12:</b> You will be entitled to an employer‚Äôs contribution of Provident fund to the extent of 12% of your basic salary and applicable ESI contribution. You will also be covered under Medical and Accident Insurance and will be entitled to all other statutory benefits whichever is applicable during the contract period. It is hereby clarified that if you fail to submit the ESIC, PF, Gratuity nomination forms together with any other document as required under the applicable labor legislations, SOURCE ONE shall not incur any liability with regards to any Claims under the said applicable labor legislations.</p>
        <p><b>13:</b> In addition to the terms contained herein, your relationship with SOURCE ONE may be subject to such other additional terms and conditions as may be communicated to you from time to time in writing by SOURCE ONE and you hereby agree to have read and clearly understood the terms of employment provided in the Service Rules, which is attached herein.</p>
        <p><b>14:</b> During your employment with SOURCE ONE, if we find any irregularity or insufficiency in the documents submitted by you, this Appointment Letter would stand cancelled / revoked.</p>
        <p><b>15:</b> The nature of your relationship with SOURCE ONE will be that of contract of service from to Upon expiry or termination of the work Assignment, your employment with SOURCE ONE shall stand terminated forthwith.</p>
        <p><b>16:</b> You shall not, either during or after termination of your employment with client give out to any third part by word of mouth or otherwise, the Proprietary and/or Confidential Information of the Company, that shall include but not limited to all information, software (whether in object or source code), statistics, data, data base, knowledge, trade secrets, inventions, products detail, know- how, formula, processes, designs, drawings, charts, maps, concepts, ideas, systems, project plans, business plans, client details, security information, any other creations of what so ever nature, kind or description, organizational matters pertaining to company or our client. Further, you shall not at any time, whether during or after the period of employment, use such Proprietary or Confidential information or any part thereof, for your own benefit or for the benefit to fan person, firm, company or other legal entity other that our client. This non-disclosure obligations enumerated above shall be binding on you at all times, irrespective of whether you continue to be employed by the company or not.</p>
        <p><b>17:</b> This appointment letter shall be co-terminus with the agreement we have with our client.</p>

        <div class="sign-row">
          <div class="sign-box">
            Employee Name: <b id="preview-employee-name">________</b>
            <img id="employee-signature-image" class="sign-image" src="" style="display:none;">
            <div style="margin-top:0.1cm;font-size:0.32cm;color:black;"><b>Accepted and Agreed</b></div>
          </div>
          <div class="sign-box" style="text-align:right;">
            <div>Source One</div><b>Chandan Lokesh</b>
            <img id="proprietor-signature" class="sign-image" src="signature.png">
            <div style="margin-top:0.1cm;font-size:0.32cm;color:black;"><b>Proprietor</b></div>
          </div>
        </div>
      </div>

      <!-- Footer Page 2 -->
      <div class="footer">
        <hr>
        <p><b>Address:</b> #49/3,MEC Road, Industrial Subrub, Marappanapalya, Yeshwanthpura, Bengaluru - 560022</p>
      </div>
    </div>
  </div>
</div>
</div>

<script>
(function(){
  const letter = document.getElementById('letter-original');
  let html = letter.innerHTML;
  html = html.replace('<u></u>','<u id="preview-startDate"></u>')
             .replace('<u></u>','<u id="preview-endDate"></u>')
             .replace('<u></u>','<u id="preview-engageDate"></u>');
  letter.innerHTML = html;

  const emp = document.getElementById('employeeName'),
        s = document.getElementById('startDate'),
        e = document.getElementById('endDate'),
        g = document.getElementById('engageDate'),
        ps = document.getElementById('preview-startDate'),
        pe = document.getElementById('preview-endDate'),
        pg = document.getElementById('preview-engageDate'),
        pname = document.getElementById('preview-employee-name'),
        sigImg = document.getElementById('employee-signature-image');

  function fmt(v){
    if(!v) return '______';
    const d = new Date(v + 'T00:00:00');
    if(isNaN(d)) return v;
    return d.toLocaleDateString(undefined,{day:'numeric',month:'short',year:'numeric'});
  }

  const today = new Date();
  const yyyy = today.getFullYear(), mm = String(today.getMonth() + 1).padStart(2,'0'), dd = String(today.getDate()).padStart(2,'0');
  const todayStr = `${yyyy}-${mm}-${dd}`;
  const nextYear = new Date(today); nextYear.setFullYear(today.getFullYear() + 1);
  const nextYearStr = `${nextYear.getFullYear()}-${String(nextYear.getMonth()+1).padStart(2,'0')}-${String(nextYear.getDate()).padStart(2,'0')}`;
  s.value = todayStr; e.value = nextYearStr; g.value = todayStr;
  e.readOnly = true; g.readOnly = true;

  function update(){
    ps.textContent = fmt(s.value);
    pe.textContent = fmt(e.value);
    pg.textContent = fmt(g.value);
    pname.textContent = emp.value.trim() || '________';
  }
  [emp,s].forEach(el=>el.addEventListener('input',update));
  s.addEventListener('input',()=>{
    const start=new Date(s.value+'T00:00:00');
    if(!isNaN(start)){
      const end=new Date(start); end.setFullYear(start.getFullYear()+1);
      e.value=`${end.getFullYear()}-${String(end.getMonth()+1).padStart(2,'0')}-${String(end.getDate()).padStart(2,'0')}`;
      g.value=s.value;
    }
    update();
  });
  update();

  const canvas=document.getElementById('sig-canvas'), ctx=canvas.getContext('2d');
  function resizeCanvas(){
    const ratio=Math.max(window.devicePixelRatio||1,1);
    canvas.width=canvas.clientWidth*ratio;
    canvas.height=canvas.clientHeight*ratio;
    ctx.scale(ratio,ratio);
    ctx.lineWidth=1.8; ctx.lineCap='round'; ctx.strokeStyle='#000';
  }
  resizeCanvas(); window.addEventListener('resize',resizeCanvas);
  let drawing=false,last={x:0,y:0};
  function pos(ev){const r=canvas.getBoundingClientRect();const t=ev.touches?ev.touches[0]:ev;return{x:t.clientX-r.left,y:t.clientY-r.top};}
  canvas.addEventListener('mousedown',e=>{drawing=true;last=pos(e);});
  canvas.addEventListener('touchstart',e=>{drawing=true;last=pos(e);e.preventDefault();},{passive:false});
  canvas.addEventListener('mousemove',e=>{if(!drawing)return;const p=pos(e);ctx.beginPath();ctx.moveTo(last.x,last.y);ctx.lineTo(p.x,p.y);ctx.stroke();last=p;});
  canvas.addEventListener('touchmove',e=>{if(!drawing)return;const p=pos(e);ctx.beginPath();ctx.moveTo(last.x,last.y);ctx.lineTo(p.x,p.y);ctx.stroke();last=p;e.preventDefault();},{passive:false});
  canvas.addEventListener('mouseup',()=>drawing=false);
  canvas.addEventListener('touchend',()=>drawing=false);
  document.getElementById('clear-sig').addEventListener('click',()=>{ctx.clearRect(0,0,canvas.width,canvas.height);sigImg.style.display='none';sigImg.src='';});
  document.getElementById('save-sig').addEventListener('click',()=>{sigImg.src=canvas.toDataURL('image/png');sigImg.style.display='block';});

 document.getElementById('generateBtn').addEventListener('click', async () => {
  if(!sigImg.src){sigImg.src = canvas.toDataURL('image/png'); sigImg.style.display='block';}
  document.getElementById('left-panel').style.display='none';
  const name = (emp.value.trim() || 'Unknown').replace(/\s+/g,'_');
  const opt = {
    margin: 1,
    filename: `EngagementLetter_${name}.pdf`,
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2, logging: false, useCORS: true },
    jsPDF: { unit: 'cm', format: 'a4', orientation: 'portrait' }
  };

  try {
    // üîπ Instead of saving directly, get PDF Blob
    const pdfBlob = await html2pdf().set(opt).from(document.getElementById('preview')).outputPdf('blob');

    // Create a temporary object URL for sharing
    const pdfUrl = URL.createObjectURL(pdfBlob);

    // Prompt user to share via native share dialog (mobile supported)
    if (navigator.share) {
      await navigator.share({
        title: 'Engagement Letter',
        text: 'Here is the generated engagement letter PDF.',
        files: [new File([pdfBlob], `EngagementLetter_${name}.pdf`, { type: 'application/pdf' })]
      });
    } else {
      // Fallback for browsers that don't support navigator.share
      const encodedUrl = encodeURIComponent(pdfUrl);
      const whatsapp = `https://wa.me/?text=Here%20is%20your%20Engagement%20Letter:%20${encodedUrl}`;
      const gmail = `mailto:?subject=Engagement%20Letter&body=Download%20your%20Engagement%20Letter%20here:%20${encodedUrl}`;
      
      const shareDiv = document.createElement('div');
      shareDiv.innerHTML = `
        <div style="text-align:center;margin-top:20px;">
          <h3>Share PDF:</h3>
          <a href="${whatsapp}" target="_blank" style="margin-right:12px;">üì± WhatsApp</a>
          <a href="${gmail}" target="_blank" style="margin-right:12px;">üìß Gmail</a>
          <a href="${pdfUrl}" target="_blank">üåê View PDF</a>
        </div>`;
      document.body.appendChild(shareDiv);
      alert('PDF ready! Use the links below to share.');
    }
  } catch (err) {
    console.error(err);
    alert('Error generating PDF.');
  }
  document.getElementById('left-panel').style.display = 'block';
});

})();
</script>
</body>
</html>
